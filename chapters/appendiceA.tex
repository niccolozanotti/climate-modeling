\chapter{Appendix }\label{app}
\section{Spherical harmonics expansion}

Spherical harmonics are key mathematical functions in the expansion of scalar and vector fields on the surface of a sphere. In climate modeling, they are extensively used for representing atmospheric and oceanic variables, such as temperature, pressure, and wind patterns, on the spherical surface of Earth.

Let's break down the \textbf{spherical harmonics expansion} in more detail, looking at its mathematical formulation, properties, and applications, especially in the context of climate modeling.

\subsubsection{1. \textbf{Mathematical Definition of Spherical Harmonics}}

The spherical harmonics $Y_l^m(\theta, \phi)$ are solutions to the Laplace equation on the sphere. They depend on two angular coordinates, \textbf{latitude} ($\theta$) and \textbf{longitude} ($\phi$).
The general form of a spherical harmonic is:
$$Y_l^m(\theta,\phi)=N_l^mP_l^m(\cos\theta)e^{im\phi}$$
Where:
\begin{itemize}
    \item $l$ is the \textbf{degree} of the harmonic, a non-negative integer ($l=0,1,2,3,â€¦$).
    \item  $m$ is the \textbf{order} of the harmonic, an integer satisfying $-l\leq m\leq l$  
    \item $P_l^m(\cos\theta)$ are the \textbf{associated Legendre polynomials}, which define the angular part of the function in terms of the \textbf{colatitude} ($\theta$).
    \item $e^{im\phi}$ is a complex exponential that encodes the \textbf{longitudinal} dependence, where $m$ controls the azimuthal symmetry.
\end{itemize}

\paragraph{\textbf{Normalization Constant}:}

The spherical harmonics are typically normalized such that:
$$N_l^m=\sqrt{\frac{(2l+1)(l-|m|)!}{4\pi(l+|m|)!}}$$
This ensures that the spherical harmonics are \textbf{orthonormal} over the surface of the sphere. That is:

$$\int_0^{\pi}\int_0^{2\pi}Y_l^m(\theta, \phi)\overline{Y_{l'}^{m'}(\theta,\phi)}\sin\theta d\theta d\phi=\delta_{l,l'}\delta_{m,m'}$$ where $\overline{Y_l^m}$
is the complex conjugate of $Y_l^m$, and $\delta$ is the \textbf{Kronecker delta}, which equals 1 if the indices are equal, and 0 otherwise.

\subsubsection{2. \textbf{Spherical Harmonics Expansion of Functions on the Sphere}}

Given a scalar field $f(\theta,\phi)$ defined on the surface of a sphere (such as the Earth's atmosphere), we can expand it in terms of spherical harmonics as a series:
$$f(\theta,\phi)=\displaystyle\sum_{l=0}^L\displaystyle\sum_{m=-l}^{l}a_l^mY_l^m(\theta,\phi)$$

Here:

\begin{itemize}
    \item $L$ is the \textbf{truncation level}, which determines the maximum degree of spherical harmonics included in the expansion.
    \item $a_l^m$ are the \textbf{spectral coefficients} that need to be determined.
\end{itemize}

\paragraph{\textbf{Computing the Coefficients}:}

To find the spectral coefficients, we use the orthonormality of the spherical harmonics. The coefficient $a_l^m$ is given by the integral:
$$a_l^m=\int_0^\pi\int_0^{2\pi}f(\theta,\phi)\overline{Y_l^m(\theta,\phi)}\sin\theta d\theta d\phi$$

This integral projects the function $f(\theta,\phi)$ onto the spherical harmonic $Y_l^m(\theta,\phi)$, extracting the corresponding coefficient.

\paragraph{\textbf{Truncation of the Series}:}

In practice, we do not include all spherical harmonics. Instead, we truncate the sum at some maximum value of l=Ll = Ll=L, which results in a finite series expansion. The truncation determines the \textbf{spectral resolution} of the model and defines the number of spherical harmonic modes included in the representation of the field.

For example:

\begin{itemize}
    \item If $L=10$, then the expansion includes all spherical harmonics from degree $l=0$ up to $l=10$.
    \item The total number of terms in the expansion is given by the sum $\displaystyle\sum_{l=0}^L(2l+1)$, which grows roughly as $L^2$.
\end{itemize}
For $L=10$, the total number of terms is:
$$N_{terms}=\displaystyle_{l=0}^{10}=1+3+5+7+9+11+13+15+17+19+21=100$$
so, the function $f(\theta,\phi)$, is approximated by a sum of 100 spherical harmonic terms.

\subsubsection{3. \textbf{Properties of Spherical Harmonics}}

\paragraph{\textbf{Orthogonality and Completeness}:}

Spherical harmonics are \textbf{orthogonal} over the surface of the sphere, meaning that any two different harmonics $Y_l^m$ and $Y_{l'}^{m'}$ are perpendicular in the function space. This property makes them ideal for decomposing a function into distinct components.

Additionally, the set of spherical harmonics forms a \textbf{complete basis} for any square-integrable function defined on the sphere. This means that any smooth function $f(\theta,\phi)$ can be represented as a (potentially infinite) sum of spherical harmonics.

\paragraph{\textbf{Symmetry}:}

\begin{itemize}
    \item The degree $l$ of a spherical harmonic determines the \textbf{angular scale} of the feature. Large values of $l$ correspond to smaller-scale features (higher-frequency components), while small values of $l$ correspond to large-scale, low-frequency components.
    \item The order $m$ determines the \textbf{longitudinal symmetry}. For each $l$ there are $2l+1$ distinct values of $m$ ranging from $-l$ to $l$ corresponding to different symmetries of the field in the longitudinal direction.
\end{itemize}
For example:

\begin{itemize}
    \item The spherical harmonic $Y_1^0(\theta,\phi)$ corresponds to a dipole, with a variation in latitude but no longitudinal variation.
    \item The spherical harmonic $Y_2^1(\theta,\phi)$ corresponds to a pattern with more complex longitudinal symmetry.
\end{itemize}

\paragraph{\textbf{Scaling}:}

The spherical harmonics have a natural scaling property. For instance, multiplying a spherical harmonic by a constant factor will change the amplitude of the corresponding mode without affecting the symmetry of the function. This property is useful for scaling fields, such as wind speeds or temperature distributions, in climate models.

\subsubsection{4. \textbf{Applications of Spherical Harmonics in Climate Models}}

In climate and weather models, spherical harmonics are used to represent global fields with high accuracy and relatively few coefficients, which is especially useful for simulating large-scale atmospheric dynamics.

Some specific applications include:

\paragraph{\textbf{Atmospheric Dynamics}:}

\begin{itemize}
    \item Atmospheric models often represent variables like pressure, temperature, and wind in terms of spherical harmonics. By expanding these fields in spherical harmonics, models can capture large-scale features such as the \textbf{zonal wind}, \textbf{jet streams}, and \textbf{planetary waves} with fewer coefficients than would be required for grid-based methods.
    \item For example, the \textbf{vorticity equation} or the \textbf{primitive equations} of motion are often solved in spectral space, and spherical harmonics are used to expand the relevant fields.
\end{itemize}

\paragraph{\textbf{Global Climate Models (GCMs)}:}

\begin{itemize}
    \item In GCMs, the Earth's climate is simulated by solving for variables (e.g., temperature, pressure, wind) at each point on the sphere. By using spherical harmonics, GCMs can efficiently model the global climate while avoiding the need for very fine grids (which would be computationally expensive).
    \item \textbf{Spectral Finite-Difference Models}: Some models combine the benefits of spectral methods for large-scale patterns with finite-difference methods for localized phenomena (like convection or boundary layers), allowing for efficient simulations of both large-scale and small-scale processes.
\end{itemize}

\paragraph{\textbf{Ocean Models}:}

Similar to atmospheric models, ocean circulation models may use spherical harmonics to represent the spatial structure of the ocean's surface currents, sea level anomalies, and other global patterns.

\paragraph{\textbf{Data Assimilation}:}

In data assimilation methods, spherical harmonics can be used to represent the state of the atmosphere or ocean at a given time, with spectral coefficients used to update the model's state based on observations.
 
\section{Vector calculus}
\subsection{Curl}
The curl of a vector field measures the tendency of the field to induce rotation around a point, or how much the field "circulates" locally. It is a vector operation applied to a vector field, and the result is another vector field. Mathematically, for a vector field $\vec{F}=(F_x, F_y, F_z)$ the curl is:
$$\nabla\times \vec{F}=\begin{vmatrix}
    \hat{i} & \hat{j} & \hat{k}\\
    \frac{\partial}{\partial x} &\frac{\partial}{\partial y} & \frac{\partial}{\partial z} \\
    F_x & F_y &F_z
\end{vmatrix}$$
$\hat{i}, \hat{j}, \hat{k}$ are the unit vectors in the $x,y,z$ directions.
The curl results in a vector field whose direction indicates the axis of rotation (using the right-hand rule), and whose magnitude indicates the strength of the rotation.  The curl represents the amount and direction of rotational motion or "swirl" in the field. In fluid dynamics, a region of nonzero curl corresponds to vorticity, where fluid particles rotate. 
\subsection{Gradient}
The gradient measures the rate and direction of the steepest increase of a scalar field. It is a vector operation applied to a scalar field, and the result is a vector field. Mathematically, for a scalar field $f(x,y,z)$:
$$\nabla f=\left(\frac{\partial f}{\partial x}, \frac{\partial f}{\partial y}, \frac{\partial f}{\partial z}\right)$$
The gradient points in the direction where the scalar field $f$ increases most rapidly.. The magnitude of the gradient gives the rate of increase in that direction. In thermodynamics, the gradient of temperature describes the direction and rate of heat flow. The result of a gradient is always a vector. 
\begin{itemize}
    \item The curl tells you about rotational behavior in a vector field.
    \item The gradient gives you the direction and rate of steepest ascent in a scalar field.
\end{itemize}
\subsection{Divergence}
In vector calculus, divergence measures the rate at which a vector field spreads out or converges at a given point. It quantifies how much the field "diverges" from or "converges" into a region. For a \textbf{vector field} $\vec{F}=(F_x,F_y,F_z)$ the divergence is defined as:
$$\nabla\cdot \vec{F}=\frac{\partial F_x}{\partial x}+\frac{\partial F_y}{\partial y}+\frac{\partial F_z}{\partial z}$$
Divergence Positive ($\nabla\cdot \vec{F}>0$ the field is "spreading out" or "expanding" at a point.
Example: A source emitting fluid, such as water spraying out of a fountain.
Divergence Negative ($\nabla\cdot \vec{F}<0$) the field is "converging" or "contracting" at a point.
Example: A sink where fluid flows inward, such as water draining into a hole.
Zero Divergence ($\nabla\cdot \vec{F}=0$) the field is neither expanding nor contracting, often indicating incompressible flow.
Example: Steady, non-divergent flow like incompressible fluid flow.

